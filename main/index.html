<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>PWA - test</title>
	<link rel="manifest" href="/manifest.json" />
	<link rel="apple-touch-icon" href="/share/images/icons/icon-152x152.png" />
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<meta name="apple-mobile-web-app-status-bar-style" content="black" />
	<meta name="apple-mobile-web-app-title" content="pwa-test" />
	<meta name="description" content="pwa-test" />
	<meta name="theme-color" content="#000" />
	<link rel="stylesheet" href="/share/style.css">
</head>
<body>
	테스트용 페이지
	<div>
		<button id="add-btn" class="install-btn" style="display:none">APP 설치</button>
	</div>
	<div>
		<button id="installed-btn" class="install-btn">앱이 설치되어있습니다</button>
	</div>

	<div id="install-pop" style="display:none;">
		<button type="button" class="pwa" onclick="addToHomeScreen()">홈화면에 추가</button>
		<button type="button" id="close-btn">닫기</button>
	</div>
	<div id="ios-install-pop" style="display:none">
		<div class="content">
			<strong>아이폰 앱설치방법입니다</strong>
			<div class="row">
				1. <img src="data:image/png;base64,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" alt="icon"> 화면하단중앙에서 왼쪽모양의 버튼 클릭
			</div>
			<div class="row">2. '홈 화면에 추가'를 눌러주세요</div>
		<button type="button" id="ios-close-btn">닫기</button>
	</div>
	<style>
		
	</style>
	<script>

		//서비스워커 등록
		if ("serviceWorker" in navigator) {
		  window.addEventListener("load", () => {
			navigator.serviceWorker.register("/service-worker.js");
		  });
		}


		var deferredPrompt;
		var addBtn = document.querySelector('#add-btn');
		var installedBtn = document.querySelector('#installed-btn');
		var iosPop = document.querySelector('#ios-install-pop');
		
		//ios로 접속시, app설치버튼에 안내문구팝업 등록
		if(isThisDeviceRunningiOS()){
			addBtn.style.display = 'block';
			installedBtn.style.display = 'none';
			addBtn.addEventListener('click', function(e){
				iosPop.style.display = 'block'			
			})
		}else{
			//일반브라우저 접속시, 크롬의 beforeinstallprompt 이벤트에 콜백등록
			window.addEventListener('beforeinstallprompt', (e) => {
				e.preventDefault();
				deferredPrompt = e;
				addBtn.style.display = 'block'
				installedBtn.style.display = 'none'

				addBtn.addEventListener('click', function(e){
					deferredPrompt.prompt();
					deferredPrompt.userChoice.then((choiceResult) => {						
						if (choiceResult.outcome === 'accepted') {
							addBtn.style.display = 'none'
							installedBtn.style.display = 'block'
						}
						deferredPrompt = null;
					});			
				})
			});
		}
				
		var closeBtn = document.querySelector('#close-btn')
		closeBtn.addEventListener('click', function(e){
			e.stopPropagation()
			installPop.style.display = 'none';
		})

		var iosCloseBtn = document.querySelector('#ios-close-btn')
		iosCloseBtn.addEventListener('click', function(e){
			e.stopPropagation()
			iosPop.style.display = 'none';
		})

		function isThisDeviceRunningiOS(){
			if (['iPad Simulator', 'iPhone Simulator','iPod Simulator', 'iPad','iPhone','iPod'].includes(navigator.platform)){
				return true;
			} else if (navigator.userAgent.includes("Mac") && "ontouchend" in document){
				// iPad on iOS 13  
				return true;
			} else {
				return false;
			}
		}

	  </script>
</body>
</html>